<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>tidymodels | talkRtive</title>
    <link>https://talkrtive.com/category/tidymodels/</link>
      <atom:link href="https://talkrtive.com/category/tidymodels/index.xml" rel="self" type="application/rss+xml" />
    <description>tidymodels</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Mon, 20 Jul 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://talkrtive.com/img/talRtive.jpg</url>
      <title>tidymodels</title>
      <link>https://talkrtive.com/category/tidymodels/</link>
    </image>
    
    <item>
      <title>Predicting the result of a Virtual football match using tidymodels</title>
      <link>https://talkrtive.com/post/tidymodels-virtual-football-prediction/</link>
      <pubDate>Mon, 20 Jul 2020 00:00:00 +0000</pubDate>
      <guid>https://talkrtive.com/post/tidymodels-virtual-football-prediction/</guid>
      <description>&lt;h2 id=&#34;after-successfully-scraping-data-from-a-football-betting-sitehahahugoshortcode-s0-hbhb--i-will-now-build-a-simple-model-using-tidymodels-r-package-to-see-how-well-it-will-perform-in-predicting-the-result-of-the-games&#34;&gt;After successfully 
&lt;a href=&#34;https://talkrtive.com/post/web-scraping-using-rselenium/&#34;&gt;scraping data from a football betting site&lt;/a&gt;  i will now build a simple model using tidymodels r package to see how well it will perform in predicting the result of the games.&lt;/h2&gt;
&lt;p&gt;Below are some information about the dataset:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;home      &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;A premier league club at home to play against an opponent&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;away      &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;A premier league club away from home to play against the home team&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;homeOdd   &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;the odds that the home team will win a particular match&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;drawOdd   &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;the odds that both teams will draw a particular match&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;awaysOdd  &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;the odds that the away team will win particular match&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;homeR     &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;result of the home team after a particular match&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;awayR     &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;result of the away team after a particular match&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;matchtime &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;the time a particular match was played&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;leagueW   &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;the week a particular match was played&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;day       &amp;ndash;&amp;gt;&lt;/strong&gt; &lt;em&gt;the day a particular match was played&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;install the tidymodels r package&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;install.packages(&amp;quot;tidymodels&amp;quot;) # skip this step if you already have the tidymodels package
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;load the package&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;require(tidyverse)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Read in the dataset and check its dimension&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;bet9ja &amp;lt;- read_csv(&amp;quot;https://raw.githubusercontent.com/twirelex/dataset/master/bet9ja(2).csv&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Parsed with column specification:
## cols(
##   home = col_character(),
##   away = col_character(),
##   homeOdd = col_double(),
##   drawOdd = col_double(),
##   awaysOdd = col_double(),
##   homeR = col_double(),
##   awayR = col_double(),
##   matchtime = col_time(format = &amp;quot;&amp;quot;),
##   leagueWK = col_character(),
##   day = col_character()
## )
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dim(bet9ja) ## see the dimension of the data
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 14410    10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Overview of the data&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;require(knitr)

kable(head(bet9ja))
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;home&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;away&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;homeOdd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;drawOdd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;awaysOdd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;homeR&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;awayR&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;matchtime&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;leagueWK&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;day&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WAT&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LIV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.52&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16:32:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WEEK 34&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Friday&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;EVE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NWC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.38&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16:32:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WEEK 34&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Friday&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;TOT&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BUR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.46&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.38&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.18&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16:32:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WEEK 34&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Friday&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;BOU&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MNU&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.54&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.30&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16:32:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WEEK 34&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Friday&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;BRI&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ASV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.29&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.02&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.53&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16:32:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WEEK 34&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Friday&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;CHE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NOR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.46&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.38&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.18&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16:32:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WEEK 34&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Friday&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;glimpse(bet9ja)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Rows: 14,410
## Columns: 10
## $ home      &amp;lt;chr&amp;gt; &amp;quot;WAT&amp;quot;, &amp;quot;EVE&amp;quot;, &amp;quot;TOT&amp;quot;, &amp;quot;BOU&amp;quot;, &amp;quot;BRI&amp;quot;, &amp;quot;CHE&amp;quot;, &amp;quot;WHU&amp;quot;, &amp;quot;WOL&amp;quot;, &amp;quot;...
## $ away      &amp;lt;chr&amp;gt; &amp;quot;LIV&amp;quot;, &amp;quot;NWC&amp;quot;, &amp;quot;BUR&amp;quot;, &amp;quot;MNU&amp;quot;, &amp;quot;ASV&amp;quot;, &amp;quot;NOR&amp;quot;, &amp;quot;SOU&amp;quot;, &amp;quot;MNC&amp;quot;, &amp;quot;...
## $ homeOdd   &amp;lt;dbl&amp;gt; 6.08, 2.38, 1.46, 3.54, 2.29, 1.46, 1.94, 4.16, 3.02, 2.0...
## $ drawOdd   &amp;lt;dbl&amp;gt; 4.37, 3.20, 4.38, 3.00, 3.02, 4.38, 3.32, 3.81, 3.19, 3.2...
## $ awaysOdd  &amp;lt;dbl&amp;gt; 1.52, 3.13, 7.18, 2.30, 3.53, 7.18, 4.25, 1.82, 2.46, 3.9...
## $ homeR     &amp;lt;dbl&amp;gt; 0, 0, 3, 0, 0, 3, 1, 2, 1, 1, 2, 1, 0, 3, 3, 5, 1, 0, 2, ...
## $ awayR     &amp;lt;dbl&amp;gt; 3, 2, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 2, 0, 3, 1, 3, 3, 1, ...
## $ matchtime &amp;lt;time&amp;gt; 16:32:00, 16:32:00, 16:32:00, 16:32:00, 16:32:00, 16:32:...
## $ leagueWK  &amp;lt;chr&amp;gt; &amp;quot;WEEK 34&amp;quot;, &amp;quot;WEEK 34&amp;quot;, &amp;quot;WEEK 34&amp;quot;, &amp;quot;WEEK 34&amp;quot;, &amp;quot;WEEK 34&amp;quot;, &amp;quot;W...
## $ day       &amp;lt;chr&amp;gt; &amp;quot;Friday&amp;quot;, &amp;quot;Friday&amp;quot;, &amp;quot;Friday&amp;quot;, &amp;quot;Friday&amp;quot;, &amp;quot;Friday&amp;quot;, &amp;quot;Friday...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we do not have a response variable yet so we need to first create a response variable before proceeding.&lt;br&gt;
we will create the new variable from our homeR and awayR variables and call the new variable &amp;ldquo;result&amp;rdquo;, we will encode the &amp;ldquo;result&amp;rdquo; variable as follow:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1 when the home team wins&lt;/li&gt;
&lt;li&gt;0 when the game ends in a draw&lt;/li&gt;
&lt;li&gt;2 when the away team wins&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;bet9ja &amp;lt;- bet9ja %&amp;gt;% 
  mutate(result = factor(case_when(homeR &amp;gt; awayR ~ 1, homeR &amp;lt; awayR ~ 2, TRUE ~ 0))) %&amp;gt;%
  select(-homeR, -awayR) # remove the homeR variable and awayR variable as we will no longer need them
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we have now added a 3 category response/dependent variable and this means that we will be building a multiclass classification model.&lt;/p&gt;
&lt;p&gt;some of the variables are represented as character variables but we will need them to be categorical variables for the sake of the algorithm we want to make use of.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;bet9ja &amp;lt;- bet9ja %&amp;gt;% 
  mutate_if(is.character, as.factor)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;data-exploration&#34;&gt;DATA EXPLORATION&lt;/h2&gt;
&lt;p&gt;If you are familiar with the way football betting works you will know that &amp;ldquo;odds&amp;rdquo; play a huge role on whether a team will win a particular game or not. So let us first visually see the relationship between the odds variables and the result variable.&lt;/p&gt;
&lt;p&gt;Let us discretize the odds variables and do a plot&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;bet9ja %&amp;gt;% 
  transmute(result, homeOdd = factor(case_when(homeOdd &amp;lt;= 1.5 ~ &amp;quot;smallO&amp;quot;, homeOdd &amp;gt; 1.5 &amp;amp; homeOdd &amp;lt;= 2 ~ &amp;quot;mediumO&amp;quot;, homeOdd &amp;gt; 2 ~ &amp;quot;bigO&amp;quot;))) %&amp;gt;% 
  ggplot(aes(result, fill = result)) + geom_bar(show.legend = FALSE) + facet_wrap(~homeOdd) + theme_bw() +scale_y_continuous(labels = NULL) + labs(y = NULL, title = &amp;quot;HOME TEAM ODDS PLOT&amp;quot;) + theme(plot.title = element_text(hjust = 0.5))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://talkrtive.com/post/predicting-the-result-of-a-virtual-football-match-of-a-betting-site/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;768&#34; /&gt;
&lt;strong&gt;The plot above is trying to convince us that when a team is home and its winning odds is big i.e above 2 then the match will likely end up in favor of its opponent(away team), but when its winning odds is small or medium i.e between 1 and 2 then the match will most likely end in favor of the team..&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;bet9ja %&amp;gt;% 
  transmute(result, awaysOdd = factor(case_when(awaysOdd &amp;lt;= 1.5 ~ &amp;quot;smallO&amp;quot;, awaysOdd &amp;gt; 1.5 &amp;amp; awaysOdd &amp;lt;= 2 ~ &amp;quot;mediumO&amp;quot;, awaysOdd &amp;gt; 2 ~ &amp;quot;bigO&amp;quot;))) %&amp;gt;% 
  ggplot(aes(result, fill = result)) + geom_bar(show.legend = FALSE) + facet_wrap(~awaysOdd) + theme_bw() +scale_y_continuous(labels = NULL) + labs(y = NULL, title = &amp;quot;AWAY TEAM ODDS PLOT&amp;quot;) + theme(plot.title = element_text(hjust = 0.5))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://talkrtive.com/post/predicting-the-result-of-a-virtual-football-match-of-a-betting-site/index_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;768&#34; /&gt;
&lt;strong&gt;According to the plot above, when a team is away and it is giving a big winning odds in a particular match i.e odds above 2, the game will likely end up in favor of the opposition team(home team), but when the team is giving a small/medium winning odds i.e between 1 and 2 then the match will likely end up in the team&amp;rsquo;s favor&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;modeling&#34;&gt;MODELING&lt;/h2&gt;
&lt;p&gt;Now that we have an idea of what the relationship between the odds variables and the result variable looks like let us go ahead and build a predictive model using the tidymodels r package.&lt;/p&gt;
&lt;p&gt;let&amp;rsquo;s build a svm model using tidymodels parsnip&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;require(doSNOW) # for parallel processing in windows OS

cl &amp;lt;- makeCluster(6, type = &amp;quot;SOCK&amp;quot;) 
registerDoSNOW(cl)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;split data into training and testing&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;require(tidymodels) # for modeling
set.seed(111)

splitdata &amp;lt;- initial_split(bet9ja)
traindata &amp;lt;- training(splitdata)
testdata &amp;lt;- testing(splitdata)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;fitting&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;svm_model &amp;lt;- svm_rbf(mode = &amp;quot;classification&amp;quot;) %&amp;gt;% 
  set_engine(&amp;quot;kernlab&amp;quot;) %&amp;gt;% 
  fit(result~., data = traindata)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;make prediction on test data and view confusion matrix&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;prediction &amp;lt;- svm_model %&amp;gt;% 
  predict(testdata) %&amp;gt;% 
  transmute(actual = testdata$result, rename(.,predicted = .pred_class)) 
kable(head(prediction, 10))
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;actual&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;predicted&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;we can see that there are few misclassifications&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;prediction %&amp;gt;% 
  conf_mat(actual, predicted) # view confusion matrix
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           Truth
## Prediction    0    1    2
##          0    5   10   12
##          1  720 1253  540
##          2  306  246  510
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;prediction %&amp;gt;% accuracy(actual, predicted) # check accuracy
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 1 x 3
##   .metric  .estimator .estimate
##   &amp;lt;chr&amp;gt;    &amp;lt;chr&amp;gt;          &amp;lt;dbl&amp;gt;
## 1 accuracy multiclass     0.491
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The svm model produced an accuracy of about 49%&lt;/p&gt;
&lt;p&gt;Now let us try to build a random forest model to see if there will be any improvement&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;set.seed(111)
rf_model &amp;lt;- rand_forest(mode = &amp;quot;classification&amp;quot;) %&amp;gt;% 
  set_engine(&amp;quot;ranger&amp;quot;, importance = &amp;quot;permutation&amp;quot;) %&amp;gt;% 
  fit(result~., data = traindata)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;make prediction on test data and view confusion matrix&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;prediction2 &amp;lt;- rf_model %&amp;gt;% 
  predict(testdata) %&amp;gt;% 
  transmute(actual = testdata$result, rename(., predicted = .pred_class)) 
kable(head(prediction2, 10))
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;actual&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;predicted&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;prediction2 %&amp;gt;% 
  conf_mat(actual, predicted) # view confusion matrix
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           Truth
## Prediction    0    1    2
##          0  135  147  141
##          1  586 1086  455
##          2  310  276  466
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;prediction2 %&amp;gt;% accuracy(actual, predicted) # check accuracy
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 1 x 3
##   .metric  .estimator .estimate
##   &amp;lt;chr&amp;gt;    &amp;lt;chr&amp;gt;          &amp;lt;dbl&amp;gt;
## 1 accuracy multiclass     0.468
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The svm model performed better judging with the Accuracy&lt;/p&gt;
&lt;p&gt;lets view how well each of the variables performed in the model&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;require(vip) # variable importance plot function &amp;quot;vip()&amp;quot;

rf_model %&amp;gt;% 
  vip(geom = &amp;quot;point&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://talkrtive.com/post/predicting-the-result-of-a-virtual-football-match-of-a-betting-site/index_files/figure-html/unnamed-chunk-19-1.png&#34; width=&#34;672&#34; /&gt;
From the plot above we can clearly see that the odds variables were the most effective predictor variables.&lt;/p&gt;
&lt;h3 id=&#34;observation&#34;&gt;OBSERVATION&lt;/h3&gt;
&lt;p&gt;Both models didn&amp;rsquo;t give us the best result but from our analysis we can see that variables that are the most significant determinant of the outcome of any virtual football game are the odds variables, the teams involved or the time/day the game is played doesn&amp;rsquo;t matter that much&amp;hellip;&lt;/p&gt;
&lt;h3 id=&#34;conclusion&#34;&gt;CONCLUSION&lt;/h3&gt;
&lt;p&gt;With an accuracy less than 50% the SVM and a random forest model are probably not the best models to depend on when it comes to virtual football game prediction.&lt;/p&gt;
&lt;h3 id=&#34;wrap-up&#34;&gt;Wrap-up&lt;/h3&gt;
&lt;p&gt;Shifting from the base r and caret way of modeling can be hard for some of us but seeing how far the tidymodels is preparing to take us (timely upgrade/update) is enough reason for everyone to start trying it out. And also, knowing that the brain behind the caret package is also part  of the tidymodels team makes it even more interesting. I have prepared a short and comprehensive lesson on tidymodels that might be helpful.. 
&lt;a href=&#34;&#34;&gt;tidymodels for noobs&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
